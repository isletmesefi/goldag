<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Saha Navigasyon – Göldağ</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <script src="https://unpkg.com/proj4@2.9.2/dist/proj4.js"></script>

  <style>
    body{margin:0;font-family:Arial;background:#0b1220;color:#e9eefc}
    header{padding:16px;background:#0e1730;border-bottom:1px solid #1c2a4a}
    h1{margin:0;font-size:20px}
    .wrap{max-width:1100px;margin:auto;padding:16px}
    .card{background:#111c3a;border:1px solid #1c2a4a;border-radius:14px;padding:16px;margin-bottom:16px}
    input,button{width:100%;padding:10px;margin-top:6px;border-radius:8px;border:1px solid #2b3c66;background:#0b1220;color:#fff}
    button{background:#1f3bff;font-weight:bold;cursor:pointer}
    #map{height:650px;border-radius:14px;border:1px solid #1c2a4a}
    .row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
  </style>
</head>

<body>
<header>
  <h1>SAHA NAVİGASYON – Göldağ</h1>
</header>

<div class="wrap">

  <div class="card">
    <h2>İşaretleme</h2>

    <div class="row">
      <input id="label" placeholder="Etiket / İstif (örn: GACAK-153)">
      <input id="easting" placeholder="UTM Easting (E)">
      <input id="northing" placeholder="UTM Northing (N)">
    </div>

    <button onclick="markUTM()">UTM ile İşaretle</button>
    <button onclick="markGPS()" style="margin-top:8px;background:#23304e">GPS ile İşaretle</button>

    <div id="msg"></div>
  </div>

  <div class="card">
    <h2>Harita</h2>
    <div id="map"></div>
  </div>

</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  const WEST=638000, EAST=657000, SOUTH=4615000, NORTH=4639000;
  const map = L.map("map",{crs:L.CRS.Simple});
  const bounds=[[SOUTH,WEST],[NORTH,EAST]];
  L.imageOverlay("goldag_map_5000w.jpg",bounds).addTo(map);
  map.fitBounds(bounds);

  const layer=L.layerGroup().addTo(map);

  const WGS84="EPSG:4326";
  const UTM36="+proj=utm +zone=36 +datum=WGS84 +units=m +no_defs";

  function markUTM(){
    layer.clearLayers();
    const E=parseFloat(easting.value);
    const N=parseFloat(northing.value);
    const t=label.value||"Nokta";
    L.marker([N,E]).addTo(layer).bindPopup(t).openPopup();
    map.setView([N,E],1);
  }

  function markGPS(){
    navigator.geolocation.getCurrentPosition(pos=>{
      const lat=pos.coords.latitude;
      const lon=pos.coords.longitude;
      const [E,N]=proj4(WGS84,UTM36,[lon,lat]);
      easting.value=E.toFixed(2);
      northing.value=N.toFixed(2);
      markUTM();
    });
  }
</script>
</body>
</html>
